import{r as i,j as e,c as R,R as E}from"./styles-8aea9f05.js";const X=()=>{const[u,b]=i.useState([]),[c,v]=i.useState("Todos"),[S,p]=i.useState({}),[f,j]=i.useState({}),[m,g]=i.useState(null),[s,C]=i.useState(null),d=i.useRef(null),a=i.useRef({isDragging:!1,originX:0,originY:0,translateX:0,translateY:0}),w=(t,l="application/pdf")=>{try{const r=atob(t.split(",")[1]),n=new Array(r.length);for(let h=0;h<r.length;h++)n[h]=r.charCodeAt(h);const o=new Uint8Array(n),x=new Blob([o],{type:l});return URL.createObjectURL(x)}catch{return t}},y=()=>{const t=localStorage.getItem("orders");t&&b(JSON.parse(t))};i.useEffect(()=>{y();const t=setInterval(y,2e3);return()=>clearInterval(t)},[]);const k=t=>{var r;p(n=>({...n,[t]:!0}));const l=((r=u.find(n=>n.id===t))==null?void 0:r.trottaStatus)||"";j(n=>({...n,[t]:l}))},O=(t,l)=>{j(r=>({...r,[t]:l}))},L=t=>{const l=u.map(r=>r.id===t?{...r,trottaStatus:f[t]}:r);b(l),localStorage.setItem("orders",JSON.stringify(l)),p(r=>({...r,[t]:!1}))},z=(t,l)=>{C(t),g(l),d.current&&(d.current.style.transform="translate(0px, 0px)",a.current.translateX=0,a.current.translateY=0)},N=t=>{a.current.isDragging=!0,a.current.originX=t.clientX,a.current.originY=t.clientY},T=()=>{a.current.isDragging=!1},W=t=>{if(!a.current.isDragging)return;const l=t.clientX-a.current.originX,r=t.clientY-a.current.originY,n=a.current.translateX+l,o=a.current.translateY+r;d.current&&(d.current.style.transform=`translate(${n}px, ${o}px)`),a.current.originX=t.clientX,a.current.originY=t.clientY,a.current.translateX=n,a.current.translateY=o},D=u.filter(t=>c==="Todos"?!0:c==="Label not available"?!t.labels||t.labels.length===0:c==="Label available"?t.labels&&t.labels.length>0:c==="Orden cancelada"?t.ghStatus==="Orden cancelado":!0);return e.jsxs("div",{className:"admin-container",children:[e.jsx("div",{className:"sidebar",children:e.jsx("h2",{children:"Panel Cliente"})}),e.jsx("div",{className:"main-content",children:e.jsxs("div",{className:"content-wrapper",children:[e.jsx("h1",{children:"Panel Cliente - Trotta Tire"}),e.jsxs("div",{className:"filter-bar",children:[e.jsx("label",{children:"Filtrar por estado del Label:"}),e.jsxs("select",{value:c,onChange:t=>v(t.target.value),children:[e.jsx("option",{value:"Todos",children:"Todos"}),e.jsx("option",{value:"Label not available",children:"Label not available"}),e.jsx("option",{value:"Label available",children:"Label available"}),e.jsx("option",{value:"Orden cancelada",children:"Orden cancelada"})]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Orden #"}),e.jsx("th",{children:"Cliente"}),e.jsx("th",{children:"Dirección"}),e.jsx("th",{children:"Orden"}),e.jsx("th",{children:"Fecha y Hora"}),e.jsx("th",{children:"Estado Gun Hill"}),e.jsx("th",{children:"Estado Shipping"}),e.jsx("th",{children:"Acción"}),e.jsx("th",{children:"Notas"}),e.jsx("th",{children:"Label"})]})}),e.jsx("tbody",{children:D.map(t=>{const l=`${t.date} ${t.time}`,r=!!S[t.id],n=t.labels||[];let o="";return t.trottaStatus==="Label available"?o="label-available":t.trottaStatus==="Cancelado - Llanta no disponible"&&(o="label-cancelado"),e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:"bold",fontSize:"1rem"},children:t.orderNumber}),e.jsx("td",{style:{fontWeight:"bold",fontSize:"1rem"},children:t.customerName}),e.jsx("td",{style:{fontWeight:"bold",fontSize:"1rem"},children:t.address}),e.jsx("td",{style:{fontWeight:"bold",fontSize:"1rem"},children:t.orderDetails}),e.jsx("td",{style:{fontWeight:"bold",fontSize:"1rem"},children:l}),e.jsx("td",{style:{fontWeight:"bold",fontSize:"1rem"},children:t.ghStatus}),e.jsx("td",{children:e.jsxs("select",{value:r?f[t.id]||"":t.trottaStatus||"",onChange:x=>O(t.id,x.target.value),disabled:!r,style:{backgroundColor:r?"#fff":"#eee",cursor:r?"pointer":"not-allowed",fontWeight:"bold",fontSize:"1rem",textAlign:"center"},children:[e.jsx("option",{value:"Cancelado - Llanta no disponible",children:"Cancelado - Llanta no disponible"}),e.jsx("option",{value:"Listo para recojida",children:"Listo para recojida"})]})}),e.jsx("td",{children:r?e.jsx("button",{onClick:()=>L(t.id),children:"Update"}):e.jsx("button",{onClick:()=>k(t.id),children:"Editar"})}),e.jsx("td",{children:e.jsx("textarea",{value:t.note,readOnly:!0,rows:2,style:{width:"100%",backgroundColor:"#f0f0f0",border:"1px solid #ccc",padding:"8px",resize:"none",cursor:"default",fontWeight:"bold",fontSize:"1rem",textAlign:"center",color:"#000"}})}),e.jsx("td",{children:n.length===0?e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:"No disponible"}):e.jsxs("button",{className:o,onClick:()=>z(t,n),title:`Ver ${n.length} label${n.length>1?"s":""}`,style:{background:"none",border:"none",padding:0,fontSize:"1.1rem",fontWeight:"bold",cursor:"pointer",textDecoration:o==="label-cancelado"?"none":"underline"},children:["📥 ",n.length," Label",n.length>1?"s":""]})})]},t.id)})})]})]})}),m&&s&&e.jsx("div",{className:"modal-overlay",onClick:()=>g(null),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:e.jsxs("div",{className:"modal-content",ref:d,onClick:t=>t.stopPropagation(),style:{position:"relative",backgroundColor:"white",padding:0,borderRadius:10,width:"70vw",maxWidth:"1000px",height:"auto",maxHeight:"80vh",boxShadow:"0 0 25px rgba(0,0,0,0.25)",display:"flex",flexDirection:"column",alignItems:"center",gap:"25px",overflow:"hidden"},children:[e.jsxs("div",{style:{cursor:"move",backgroundColor:"#007bff",color:"white",padding:"12px 20px",fontWeight:"700",fontSize:"1.25rem",userSelect:"none",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",borderTopLeftRadius:"10px",borderTopRightRadius:"10px"},onMouseDown:N,onMouseUp:T,onMouseMove:W,children:[e.jsxs("span",{children:["Información de la Orden #",s.orderNumber]}),e.jsx("button",{onClick:()=>g(null),style:{background:"transparent",border:"none",color:"white",fontSize:"26px",fontWeight:"700",cursor:"pointer",lineHeight:1,width:"40px",height:"40px",borderRadius:"8px",display:"flex",justifyContent:"center",alignItems:"center",transition:"background-color 0.3s"},onMouseOver:t=>t.currentTarget.style.backgroundColor="rgba(255,255,255,0.2)",onMouseOut:t=>t.currentTarget.style.backgroundColor="transparent","aria-label":"Cerrar",children:"×"})]}),e.jsxs("div",{style:{padding:"0 40px 20px 40px",width:"100%",maxWidth:"960px",fontWeight:"700",fontSize:"1.15rem",lineHeight:1.5,color:"#000000",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",justifyContent:"center",textAlign:"center"},children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Cliente:"})," ",s.customerName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Dirección:"})," ",s.address]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Producto:"})," ",s.orderDetails]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha y Hora:"})," ",s.date," ",s.time]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Estado Gun Hill:"})," ",s.ghStatus]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Estado Shipping:"})," ",s.trottaStatus]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Notas:"})," ",s.note]})]})]}),m.map((t,l)=>{const r=w(t.data);return e.jsx("div",{style:{marginBottom:"15px",textAlign:"center",width:"100%",display:"flex",justifyContent:"center"},children:e.jsxs("button",{onClick:()=>{const n=window.open(r,"_blank","width=800,height=600");n?(n.focus(),n.onload=()=>n.print()):alert("Permite ventanas emergentes para imprimir.")},style:{padding:"14px 28px",fontSize:"1.2rem",cursor:"pointer",borderRadius:"7px",border:"1px solid #007bff",backgroundColor:"#007bff",color:"white",transition:"background-color 0.3s"},onMouseOver:n=>n.currentTarget.style.backgroundColor="#0056b3",onMouseOut:n=>n.currentTarget.style.backgroundColor="#007bff",children:["Imprimir Label ",l+1]})},l)})]})}),e.jsx("style",{children:`
        @keyframes pulse {
          0% { opacity: 1; }
          50% { opacity: 0.5; }
          100% { opacity: 1; }
        }
        .label-available {
          font-weight: bold;
          font-size: 1.1rem;
          color: green;
          animation: pulse 2s infinite;
          cursor: pointer;
          background: none;
          border: none;
          text-decoration: underline;
          padding: 0;
        }
        .label-cancelado {
          font-weight: bold;
          font-size: 1.1rem;
          color: red;
          cursor: default;
          background: none;
          border: none;
          text-decoration: none;
          padding: 0;
        }
      `})]})};R.createRoot(document.getElementById("root")).render(e.jsx(E.StrictMode,{children:e.jsx(X,{})}));
